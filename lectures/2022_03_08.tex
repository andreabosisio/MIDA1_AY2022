%!TEX root = ../main.tex
\section{Non-zero mean ARMA processes}
Consider now $y(t)$ ARMA process generated as the steady-state output of a linear operator $W(z)$ that receive as input $e(t)$, where $e(t) \approx W N\left(\mu, \lambda^{2}\right)$, with $\mu\neq0$.

\textbf{Gain theorem}: the steady-state output is constant and it holds that:
\begin{align*}
	\mathbb{E}[y(t)]=m_{y}=W(z)|_{z=1} \cdot \mu
\end{align*}
Indeed:
\begin{align*}
		\mathbb{E}[y(t)] &=\mathbb{E}\left[a_{1} y(t-1)+\ldots+a_{m} y(t-m)+c_{0} e(t)+\ldots+c_{n} e(t-n)\right] \\
		&=a_{1} \mathbb{E}[y(t-1)]+\ldots+a_{m} \mathbb{E}[y(t-m)]+c_{0} \mathbb{E}[e(t)]+\ldots+c_{n} \mathbb{E}[e(t-n)]
\end{align*}
	$$
	m_{y}=a_{1} m_{y}+\ldots+a_{m} m_{y}+c_{0} \cdot \mu+\ldots+c_{n} \cdot \mu
	$$
	i.e. $m_{y}=\frac{c_{0}+c_{1}+\ldots+c_{n}}{1-a_{1}-\ldots-a_{m}} \cdot \mu=W(1) \cdot \mu$.
	
Define two new processes (\textbf{unbiased} processes)
$$
\left\{\begin{array}{l}
	\tilde{y}(t)=y(t)-m_{y} \quad\forall t\\
	\tilde{e}(t)=e(t)-m_{e} \quad\forall t
\end{array} \rightarrow \begin{array}{l}
	\mathrm{E}[\tilde{y}(t)]=\mathrm{E}[y(t)]-m_{y}=0 \\
	\mathrm{E}[\tilde{e}(t)]=\mathrm{E}[e(t)]-m_{e}=0
\end{array}\right.
$$
\begin{align*}
	\tilde{y}(t)=& y(t)-m_{y}=\\
	=& a_{1} y(t-1)+\ldots+a_{m} y(t-m)+c_{0} e(t)+\ldots+c_{n} e(t-n)-m_{y} \\
	=& a_{1}\left(\bar{y}(t-1)+m_{y}\right)+\ldots+a_{m e}\left(\bar{y}(t-m)+m_{y}\right)+\\
	&+c_{0}\left(\tilde{e}(t)+m_{e}\right)+_{\ldots}+c_{n}\left(\bar{e}(t-n)+m_{e}\right)-m_{y}= \\
	=& a_{1} \tilde{y}(t-1)+\ldots+a_{m} \tilde{y}(t-m)+c_{0} \tilde{e}(t)+\ldots+c_{n} \tilde{e}(t-n) \\
	&\underbrace{-\left(1-a_{1}-\ldots-a_{m}\right) m_{y}+\left(c_{0}+\ldots c_{n}\right) m_{e}} \\
	& \text { This term is null, remember that } m_{y}=\frac{c_{0}+c_{1}+\ldots+c_{n}}{1-a_{1}-\ldots-a_{m e}} m_{e}=W(1) \cdot \mu
\end{align*}
Hence,
$$
\tilde{y}(t)=a_{1} \tilde{y}(t-1)+\ldots+a_{m} \tilde{y}(t-m)+c_{0} \tilde{e}(t)+\ldots+c_{n} \tilde{e}(t-n)
$$
where $\tilde{e}(t)\approx W N\left(0, \lambda^{2}\right)$, is Standard zero mean ARMA process.

$\tilde{y}(t)$ is the steady-state solution to $W(z)=\frac{A(z)}{C(z)}$ (same transfer function as before) fed by $\tilde{e}(t)$.

Moreover,
$$
\gamma_{y}(\tau)=\mathbb{E}\left[\left(y(t)-m_{y}\right) \cdot\left(y(t-\tau)-m_{y}\right)\right]=\mathbb{E}[(\tilde{y}(t)) \cdot(\tilde{y}(t-\tau))]=\gamma_{\tilde{y}}(\tau)
$$

Pay attention, we cannot drop $m_{y} \neq 0 $! ! ! 

$$\quad \gamma_{y}(\tau) \neq \mathrm{E}[y(t) \cdot y(t-\tau)]$$

We can see this method graphically:

\fg{0.6}{Screenshot (19)}

\section{ARMAX(ARX) processes}
ARMA processes with eXogenous input.

%% I/O systems
A process $y(t)$, generated by a remote white noise input $e(t)$ and by an exogenous (measurable) input $u(t)$, is an ARMAX process if:
\begin{align*}
	y(t)&=a_{1} y(t-1)+a_{2} y(t-2)+\ldots+a_{m} y(t-m)+\quad\quad \text{AR(m) part}\\
	&+c_{0} e(t)+c_{1} e(t-1)+\ldots+c_{n} e(t-n)+\quad\quad \text{MA(n) part} \\
	&+b_{0} u(t-k)+b_{1} u(t-k-1)+\ldots+b_{p} u(t-k-p) \quad\quad \mathrm{X}(k, p) \text{ part}
\end{align*}

ARMAX($m,n,p,k$) ARMAX process of orders $m,n,p$ with input delay between input $u(t)$ and ouput $y(t)$ equal to $k$.

ARX=ARMAX($m,p,0$).

Then:
\begin{align*}
	y(t)=& \frac{\left(b_{0}+b_{1} z^{-1}+\ldots+b_{p} z^{-p}\right) z^{-k}}{\left(1-a_{1} z^{-1}-a_{2} z^{-2}-\ldots-a_{m} z^{-m}\right)} u(t)+\\
	&+\frac{\left(c_{0}+c_{1} z^{-1}+\ldots+c_{n} z^{-n}\right)}{\left(1-a_{1} z^{-1}-a_{2} z^{-2}-\ldots-a_{m} z^{-m}\right)} e(t)
\end{align*}
i.e.
$$
y(t)=\frac{B(z) z^{-k}}{A(z)} u(t)+\frac{C(z)}{A(z)} e(t)
$$
where:

 $\begin{array}{ll}\quad & B(z)=\left(b_{0}+b_{1} z^{-1}+\ldots+b_{p} z^{-p}\right) \\ & C(z)=\left(c_{0}+c_{1} z^{-1}+\ldots+c_{n} z^{-n}\right) \\ &A(z) =\left(1-a_{1} z^{-1}-a_{2} z^{-2}-\ldots-a_{m} z^{-m}\right)\end{array}$

Both $\frac{B(z) z^{-k}}{A(z)}$ and $\frac{C(z)}{A(z)}$ are transfer functions.

An ARMAX processes can be seen as the sum of a deterministic part (output of $\frac{B(z) z^{-k}}{A(z)}$ fed by $u(t)$) and a stochastic part (output of $\frac{C(z)}{A(z)}$ fed by $e(t)$,ARMA).

In the ARX process $C(z)=1$.