%!TEX root = ../main.tex
\section{Non-zero mean ARMA processes}
Consider now $y(t)$ ARMA process generated as the steady-state output of a linear operator $W(z)$ that receive as input $e(t)$, where $e(t) \approx \WN\left(\mu, \lambda^{2}\right)$, with $\mu\neq0$.

\begin{theorem}[Gain theorem]
	The steady-state output is constant and it holds that:
	\[
		\mathbb{E}[y(t)]=m_{y}=W(z)|_{z=1} \cdot \mu
	\]
\end{theorem}

Indeed:
\begin{align*}
		\mathbb{E}[y(t)] &=\mathbb{E}\left[a_{1} y(t-1)+\cdots+a_{m} y(t-m)+c_{0} e(t)+\cdots+c_{n} e(t-n)\right] \\
		&=a_{1} \mathbb{E}[y(t-1)]+\cdots+a_{m} \mathbb{E}[y(t-m)]+c_{0} \mathbb{E}[e(t)]+\cdots+c_{n} \mathbb{E}[e(t-n)]
\end{align*}
$$
m_{y}=a_{1} m_{y}+\cdots+a_{m} m_{y}+c_{0} \cdot \mu+\cdots+c_{n} \cdot \mu
$$
i.e. $m_{y}=\frac{c_{0}+c_{1}+\cdots+c_{n}}{1-a_{1}-\cdots-a_{m}} \cdot \mu=W(1) \cdot \mu$.
	
Define two new processes (\emph{unbiased} processes)
$$
\begin{cases}
	\tilde{y}(t)=y(t)-m_{y} \quad\forall t\\
	\tilde{e}(t)=e(t)-m_{e} \quad\forall t
\end{cases}
\rightarrow \begin{array}{l}
	\mathbb{E}[\tilde{y}(t)]=\mathbb{E}[y(t)]-m_{y}=0 \\
	\mathbb{E}[\tilde{e}(t)]=\mathbb{E}[e(t)]-m_{e}=0
\end{array}
$$
\begin{align*}
	\tilde{y}(t)&= y(t)-m_{y}\\
	&= a_{1} y(t-1)+\cdots+a_{m} y(t-m)+c_{0} e(t)+\cdots+c_{n} e(t-n)-m_{y} \\
	&= a_{1}\left(\bar{y}(t-1)+m_{y}\right)+\cdots+a_{m e}\left(\bar{y}(t-m)+m_{y}\right)+\\
	&\qquad +c_{0}\left(\tilde{e}(t)+m_{e}\right)+\cdots+c_{n}\left(\bar{e}(t-n)+m_{e}\right)-m_{y} \\
	&= a_{1} \tilde{y}(t-1)+\cdots+a_{m} \tilde{y}(t-m)+c_{0} \tilde{e}(t)+\cdots+c_{n} \tilde{e}(t-n) \\
	&\qquad \underbrace{-\left(1-a_{1}-\cdots-a_{m}\right) m_{y}+\left(c_{0}+\cdots c_{n}\right) m_{e}}_{=0\text { since } m_{y}=\frac{c_{0}+c_{1}+\cdots+c_{n}}{1-a_{1}-\cdots-a_{m e}} m_{e}=W(1) \cdot \mu} \\
\end{align*}
Hence,
$$
\tilde{y}(t)=a_{1} \tilde{y}(t-1)+\cdots+a_{m} \tilde{y}(t-m)+c_{0} \tilde{e}(t)+\cdots+c_{n} \tilde{e}(t-n)
$$
where $\tilde{e}(t)\approx \WN\left(0, \lambda^{2}\right)$, is Standard zero mean ARMA process.

$\tilde{y}(t)$ is the steady-state solution to $W(z)=\frac{A(z)}{C(z)}$ (same transfer function as before) fed by $\tilde{e}(t)$.

Moreover,
$$
\gamma_{y}(\tau)=\mathbb{E}\left[\left(y(t)-m_{y}\right) \cdot\left(y(t-\tau)-m_{y}\right)\right]=\mathbb{E}[(\tilde{y}(t)) \cdot(\tilde{y}(t-\tau))]=\gamma_{\tilde{y}}(\tau)
$$

\textbf{Remark.} We cannot drop $m_{y} \neq 0$.

$$\quad \gamma_{y}(\tau) \neq \mathbb{E}[y(t) \cdot y(t-\tau)]$$

We can see this method graphically:

\fg{0.6}{Screenshot (19)}

\section{ARMAX(ARX) processes}
ARMA processes with eXogenous input.

%% I/O systems
A process $y(t)$, generated by a remote \gls{wn} input $e(t)$ and by an exogenous (measurable) input $u(t)$, is an ARMAX process if:
\begin{align*}
	y(t)&=a_{1} y(t-1)+a_{2} y(t-2)+\cdots+a_{m} y(t-m)+ &\text{AR($m$) part}\\
	&\qquad+c_{0} e(t)+c_{1} e(t-1)+\cdots+c_{n} e(t-n)+ &\text{MA($n$) part} \\
	&\qquad+b_{0} u(t-k)+b_{1} u(t-k-1)+\cdots+b_{p} u(t-k-p)  &\text{X($k,p$) part}
\end{align*}

ARMAX($m,p,n,k$) denotes an ARMAX process of orders $m,p,n$ with input delay between input $u(t)$ and ouput $y(t)$ equal to $k$.

ARX($m,p$) equals to ARMAX($m,p,0$).

Then:
\begin{align*}
	y(t) &= \frac{\left(b_{0}+b_{1} z^{-1}+\cdots+b_{p} z^{-p}\right) z^{-k}}{\left(1-a_{1} z^{-1}-a_{2} z^{-2}-\cdots-a_{m} z^{-m}\right)} u(t)+\frac{\left(c_{0}+c_{1} z^{-1}+\cdots+c_{n} z^{-n}\right)}{\left(1-a_{1} z^{-1}-a_{2} z^{-2}-\cdots-a_{m} z^{-m}\right)} e(t)\\
	&=\frac{B(z) z^{-k}}{A(z)} u(t)+\frac{C(z)}{A(z)} e(t)
\end{align*}
where:
\begin{align*}
	B(z) &= \left(b_{0}+b_{1} z^{-1}+\cdots+b_{p} z^{-p}\right)\\
	C(z) &= \left(c_{0}+c_{1} z^{-1}+\cdots+c_{n} z^{-n}\right)\\
	A(z) &= \left(1-a_{1} z^{-1}-a_{2} z^{-2}-\cdots-a_{m} z^{-m}\right)
\end{align*}

Both $\frac{B(z) z^{-k}}{A(z)}$ and $\frac{C(z)}{A(z)}$ are transfer functions.

An ARMAX processes can be seen as the sum of a deterministic part (output of $\frac{B(z) z^{-k}}{A(z)}$ fed by $u(t)$) and a stochastic part (output of $\frac{C(z)}{A(z)}$ fed by $e(t)$, ARMA).

In the ARX process $C(z)=1$.

\section{Analysis in the Frequency Domain}
\begin{definition}
	The spectral density of a S.S.P. $y(t)$ (also called the \textbf{spectrum} of $y(t)$ ) is defined as:
	\[
		\Gamma_{y}(\omega)=\sum_{t=-\infty}^{+\infty} \gamma_{y}(\tau) \cdot e^{-j \omega \tau}.
	\]
\end{definition}

In other words, $\Gamma_y(\omega)$ is defined as the Fourier transform of the covariance function.

Properties of $\Gamma_{y}(\omega)$:
\begin{enumerate}
	\item is a real function of the real variable $\omega$, $\operatorname{Im}\left(\Gamma_{y}(\omega)\right)=0 \quad \forall \omega \in \Re$
	\item is a positive function,
	$$
		\Gamma_{y}(\omega) \geq 0 \quad \forall \omega \in \mathbb{Y}^{\mathrm{r}}
	$$
	\item is aa even function,
	$$
		\Gamma_{y}(\omega)=\Gamma_{y}(-\omega) \quad \forall \omega \in \Re
	$$
	\item is $2\pi$-periodic: $\Gamma_{y}(\omega)=\Gamma_{y}(\omega+k \cdot 2 \pi) \quad \forall \omega \in \Re, \forall k \in \mathbb{Z}$.
\end{enumerate}

\textbf{Observation.}
As a consequence of 3) and 4), we will plot the spectral density in the interval $[0, \pi]$.

\textbf{Example.}
Let us consider $e(t) \sim \WN\left(\mu, \lambda^{2}\right)$. 

Covariance function:
\[
	\gamma_{e}(\tau)= \begin{cases}\lambda^{2} & \text { if } \tau=0 \\ 0 & \text { if } \tau \neq 0\end{cases}
\]


Spectral density:
\[
	\Gamma_{e}(\omega) =\sum_{\tau=-\infty}^{+\infty} \gamma_{e}(\tau) \cdot e^{-j \omega \tau}=\gamma_{e}(0) e^{-j \omega 0}+\gamma_{e}(1) e^{-j \omega}+\gamma_{e}(-1) e^{j \omega}+\cdots=\gamma_{e}(0)=\lambda^{2}
\]
\gls{wn} have constant and equal to $\lambda^{2}$ spectral density.

\textbf{Example} (MA(1) process)

$y(t)=e(t)+c \cdot e(t-1), c \in \mathcal{R}$ (real coefficient)
$e(t)\sim \WN(0,\lambda^{2} )$

\begin{align*}
	&\gamma_{y}(0)=\left(1^{2}+c^{2}\right) \cdot \lambda^{2}=(1+c^{2})\lambda^{2}\\
	&\gamma_{y}(1)=(1 \cdot c) \cdot \lambda^{2}=c\lambda^{2} \\
	&\gamma_{y}(\tau)=0 \text { when } \tau=\ldots, \pm 3, \pm 4, \ldots .
\end{align*}
Spectral density (via the definition):
\begin{align*}
	\Gamma_{y}(\omega)&=\sum_{\tau=-\infty}^{+\infty} \gamma_{y}(\tau) \cdot e^{-j \omega \tau}= \\
	&\text{(only $=\gamma_{y}(0), \gamma_{y}(\pm 1)\left(e^{-j \omega}\right)$ are not null)} \\
	&=\gamma_{y}(0)+\gamma_{y}(1)\left(e^{-j \omega}\right)+\gamma_{y}(-1)\left(e^{+j \omega}\right)+0= \\
	&=1+c^{2}+c\left(e^{-j \omega}+e^{j \omega}\right)
\end{align*}

Euler representation of the exponential
$$
e^{-j \omega}+e^{+j \omega}=\cos (\omega)-j \sin (\omega)+\cos (\omega)+j \sin (\omega)=2 \cos (\omega)
$$

We have:
$$\Gamma_y(\omega)=1+c^{2}+2 c \cos (\omega).$$
which is real, even and periodic with period $2 \pi$.

Let the process $y(t)$ be the steady-state output of an asymptotically stable digital filter fed by an S.S.P., i.e. $y(t)=F(z) v(t)$.

Then, the following formula for the spectral density of $y(t)$ holds:
$$\Gamma_{y}(\omega)=|F\left(e^{j \omega}\right)|^{2} \cdot \Gamma_{v}(\omega)$$

\begin{itemize}
	\item $\Gamma_{y}(\omega)$ is the output spectral density;
	\item $\left|F\left(e^{j \omega}\right)\right|^{2}$ is the square absolute value of the filter transfer function evaluate for $z=e^{j \omega}$ (filter frequency response);
	\item $\Gamma_{v}(\omega)$ is the input spectral density.
\end{itemize}

If the input $v(t)$ is a \gls{wn} with variance $\lambda^{2}$, then:
$$
\Gamma_{y}(\omega)=\left|F\left(e^{j \omega}\right)\right|^{2} \lambda^{2}
$$

\textbf{Example.} (MA(1) process)

$y(t)=e(t)+c \cdot e(t-1), c \in \mathcal{R}$ (real coefficient)
$e(t)\sim \WN(0,\lambda^{2} )$

$$
y(t)=\left(1+c z^{-1}\right) e(t)
$$
$$
\Gamma_{y}(\omega)=\left|1+c e^{-j \omega}\right|^{2} \cdot \lambda^{2}
$$
Recalling that:
\begin{itemize}
	\item $|a+j b|^{2}=(a+j b)(a-j b)=a^{2}+b^{2}$
	\item $1+c e^{-j \omega}=1+c \cos (-\omega)+j \sin (-\omega)=1+c \cos (\omega)-j \sin (\omega)$ $1+c e^{+j \omega}=1+c \cos (\omega)+j \sin (\omega)$
\end{itemize}

$$
\Gamma_{y}(\omega)=\left(1+c e^{-j \omega}\right)\left(1+c e^{+j \omega}\right)\cdot \lambda^{2}=(1+c^{2}+c\left(e^{j \omega}+e^{-j \omega}\right))\cdot \lambda^{2}=(1+c^{2}+2 c \cos (\omega))\cdot \lambda^{2}
$$

\fg{0.7}{Screenshot (20)}

Moreover:
\begin{align*}
	|1+c e^{-j \omega}|^2&=\left(1+c e^{-j \omega}\right)\left(1+c e^{+j \omega}\right)\\
	&=\underbrace{\left(1+c z^{-1}\right)}_\text{where $z=e^{j \omega}$}\underbrace{\left(1+c z^{-1}\right)}_\text{where $z=e^{-j \omega}$}
\end{align*}
\begin{align*}
	W(z)=\frac{C(z)}{A(z)}=\frac{(1+q_1z^{-1})\cdots(1+q_nz^{-1})}{(1+p_1z^{-1})\cdots(1+p_mz^{-1})}
\end{align*}
where $q_i$ are the zeros and $p_i$ the poles.

\begin{align*}
	\left|W\left(e^{j \omega}\right)\right|^{2}&=\frac{|1+q_1e^{-j \omega}|^2\cdots|1+q_ne^{-j \omega}|^2}{|1+p_1e^{-j \omega}|^2\cdots|1+p_me^{-j \omega}|^2}\\
	&=\frac{(1+q_1e^{-j \omega})\cdots(1+q_ne^{-j \omega})}{(1+p_1e^{-j \omega})\cdots(1+p_me^{-j \omega})}\cdot\frac{(1+q_1e^{j \omega})\cdots(1+q_ne^{j \omega})}{(1+p_1e^{j \omega})\cdots(1+p_me^{j \omega})}\\
			&=W\left(e^{j \omega}\right)\cdot W\left(e^{-j \omega}\right)
\end{align*}